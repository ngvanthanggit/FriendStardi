{% extends 'main.html' %}

{% block content %}
<h1> {{room.name}} </h1>

<body>
    <p> Content: {{room.name}} </p> 

    <style>
        .room-container {
            display: grid;
            grid-template-columns: 3fr 1fr;
        }
        .comment-form {
            display: block;
            margin: 20px 0px 50px 10px;
        }
    </style>

    <div class="room-container">
        <div class="comment-wrapper" id="comment-section">
            <h3> Conversation </h3>
            <hr>
            {% for message in room_messages %}
            <span> 
                <a href="{% url 'profile' message.user.username %}">@{{message.user}}</a>  
                {{message.created|timesince}} ago 
            </span>

            {% if request.user == message.user %}
            <a href="{% url 'delete-message' room.id message.id %}"> Delete </a>
            {% endif %}
            <br>
            
            {{message.body}}
            <hr>
            {% endfor %}

            <div class="comment-form">
                <form method="POST" action="">
                    {% csrf_token %}
                    <input type="text" name="new_comment" placeholder="Write your message here..."/
                     style="width: 50%; height: 40px;">
                </form>
            </div>
        </div>

        <div class="participants-section">
            <h3> Participants </h3>
            <hr>
            {% for participant in room_participants %}
            <a href="{% url 'profile' participant.username %}">
                @{{participant.username}}
            </a>
            <br>
            {% endfor %}
        </div>
    </div>
    {% comment %} <button type="button" onclick="navigate_to('comment-section')"> go to comment section </button> {% endcomment %}

    {% if all_messages == 0 %}
    <a href="{% url 'room' room.id %}"> Show full conversations </a>
    {% endif %}

    <script>
        function navigate_to(section_id) {
            document.getElementById(section_id).scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>

{% endblock %}